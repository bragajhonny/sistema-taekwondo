<!DOCTYPE HTML>
<html>
	<head>
		<title>Cadastro - CT Gerivaldo Silva</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>

	<body class="is-preload">
	<!-- Wrapper -->
	<div id="wrapper">
		<!-- Header -->
		<header id="header">
			<div class="inner">
				<!-- Logo -->
				<a href="index.html" class="logo">
					<span class="symbol"><img src="images/logo.svg" alt="" /></span><span class="title">CT Gerivaldo Silva</span>
				</a>
			</div>
		</header>

		<!-- Main -->
		<div id="main">
			<div class="inner">
				<h1>Cadastro</h1>
						
				<table>
					<tbody>
						<tr>
							<td>Nome</td>
							<td><input type="text" id="nome" placeholder="Nome completo"></td>
						</tr>
						<tr>
							<td>Data de nascimento</td>
							<td><input type="date" id="dataNascimento"></td>
						</tr>
						<tr>
							<td>Sexo</td>
							<td>
								<select id="sexo">
									<option value="">- Selecione -</option>
									<option value="Feminino">Feminino</option>
									<option value="Masculino">Masculino</option>
								</select>
							</td>
						</tr>
						<tr>
							<td>RG</td>
							<td><input type="text" id="rg" placeholder="RG"></td>
						</tr>
						<tr>
							<td>CPF</td>
							<td><input type="text" id="cpf" placeholder="CPF"></td>
						</tr>
						<tr>
							<td>Endereço</td>
							<td><input type="text" id="endereco" placeholder="Endereço"></td>
						</tr>
						<tr>
							<td>Telefone</td>
							<td><input type="text" id="telefone" placeholder="Telefone"></td>
						</tr>
						<tr>
							<td>Tipo Sanguineo</td>
							<td><input type="text" id="tipoSanguineo" placeholder="Tipo sanguineo"></td>
						</tr>
						<tr>
							<td>E-mail</td>
							<td><input type="email" id="email" placeholder="E-mail"></td>
						</tr>
						<tr>
							<td>Senha</td>
							<td><input type="password" id="senha" placeholder="Senha"></td>
						</tr>
					</tbody>
				</table>
				<ul class="actions">
					<li><input type="submit" value="Cadastrar" class="primary" onclick="cadastrar()" /></li>
					<li>Já tem uma conta? Faça seu <a href="index.html">login aqui.</a></li>
				</ul>
			</div>
		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

<script>
const API_URL = 'https://script.google.com/macros/s/AKfycbxs1J9CsVSyigTdwrhWx7gu2BoO1KMTszlKubzy4Zh3LWKK99XGts9xpdR2wVPWJXUFiA/exec';

function cadastrar() {
  const dados = {
    nome: nome.value.trim(),
    dataNascimento: dataNascimento.value,
    sexo: sexo.value,
    rg: rg.value.trim(),
    cpf: cpf.value.trim(),
    endereco: endereco.value.trim(),
    telefone: telefone.value.trim(),
    tipoSanguineo: tipoSanguineo.value.trim(),
    email: email.value.trim(),
    senha: senha.value.trim()
  };

  for (let campo in dados) {
    if (!dados[campo]) {
      alert('Preencha todos os campos');
      return;
    }
  }

  const formData = new FormData();
  formData.append('acao', 'cadastrarAluno');

  for (let campo in dados) {
    formData.append(campo, dados[campo]);
  }

  fetch(API_URL, {
    method: 'POST',
    body: formData
  })
  .then(res => res.json())
  .then(data => {
    if (data.status === 'sucesso') {
      alert('Cadastro realizado com sucesso');
      window.location.href = 'index.html';
    } else {
      alert(data.msg);
    }
  })
  .catch(err => {
    console.error(err);
    alert('Erro ao cadastrar aluno');
  });
}
</script>







<!--		
<script>
    const firebaseConfig = {
      apiKey: "AIzaSyDTcmFtCpgb-krAJ6OniJSXIXnkoxGzWF4",
      authDomain: "sistema-taekwondo-1.firebaseapp.com",
      projectId: "sistema-taekwondo-1",
      messagingSenderId: "635745416768",
      appId: "1:635745416768:web:58d23eca722878f047d1a5"
    };

    firebase.initializeApp(firebaseConfig);

    const auth = firebase.auth();
    const db = firebase.firestore();

    function cadastrar() {
      const dados = {
        nome: nome.value.trim(),
        dataNascimento: dataNascimento.value,
        sexo: sexo.value,
        rg: rg.value.trim(),
        cpf: cpf.value.trim(),
        endereco: endereco.value.trim(),
        telefone: telefone.value.trim(),
        tipoSanguineo: tipoSanguineo.value.trim(),
        email: email.value.trim(),
        senha: senha.value.trim()
      };

      // validação básica
      for (let campo in dados) {
        if (!dados[campo]) {
          alert("Preencha todos os campos");
          return;
        }
      }

      auth.createUserWithEmailAndPassword(dados.email, dados.senha)
        .then(cred => {
          return db.collection("alunos").doc(cred.user.uid).set({
            nome: dados.nome,
            dataNascimento: dados.dataNascimento,
            sexo: dados.sexo,
            rg: dados.rg,
            cpf: dados.cpf,
            endereco: dados.endereco,
            telefone: dados.telefone,
            tipoSanguineo: dados.tipoSanguineo,
            email: dados.email,
            perfil: "aluno",
            faixa: "",
            cadastroCompleto: true,
            criadoEm: firebase.firestore.FieldValue.serverTimestamp()
          });
        })
        .then(() => {
          alert("Cadastro realizado com sucesso");
          window.location.href = "aluno.html";
        })
        .catch(err => {
          console.error(err);
          alert(err.message);
        });
    }
  </script> -->

	</body>
</html>
